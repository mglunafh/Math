
\begin{prop} Пусть $A$ --- это область главных идеалов, $a,b_1,b_2 \in A.$
\begin{enumerate}
	\item Если $\gcd(a,b_1)=\gcd(a,b_2)=1,$ то $\gcd(a,b_1b_2)=1.$
	\item Если $a|b_1b_2$ и $\gcd(a,b_1)=1,$ то $a|b_2.$
\end{enumerate}
\end{prop}

\begin{proof}
\begin{enumerate}
	\item 
Перемножим два равенства $1=ax_1+b_1y_1$ и $1=ax_2+b_2y_2$  и получим, что единица представляется в виде линейной комбинации $a$ и $b_1b_2$: $$ 1 =(ax_1+b_1y_1)(ax_2+b_2y_2) = a(ax_1x_2+x_1b_2y_2+x_2b_1y_1) + b_1b_2(y_1y_2).$$
	\item  
	$$ ax+b_1y = 1,$$
	$$ axb_2+b_1b_2y = b_2.$$
	Заметим, что $a$ делит правую часть. А раз так, то $a|b_2.$
\end{enumerate}
\end{proof}

\setcounter{cor}{0}
\begin{cor} Пусть $A$ --- область главных идеалов, $a,b,p\in A,$ $p$ неприводим, $p|ab.$ Тогда либо $p|a$, либо $p|b$.
\end{cor}
\begin{proof}
Предположим, что $p \not | a,$ и докажем, что в таком случае $p|b.$ Обозначим через $d=\gcd(p,a).$ Раз $d|p,$ то $p=de,$ откуда следует, что либо $d$, либо $e$ обратим. Покажем, что второй случай ведет к противоречию. Пусть $e$ обратим, тогда элементы $p$ и $d$ ассоциированы, а отсюда вытекает равенство $a=de_1= pe^{-1}e_1,$ противоречащее исходному предположению. 

Итак, в равенстве $p = de$ оказался обратим наибольший общий делитель $d$. 
$$ d = ax+py,$$
$$ 1 = d^{-1}ax + d^{-1}py,$$
$$ b = bd^{-1}ax + bd^{-1}py = ab(d^{-1}x) + p(bd^{-1}y).$$
Элемент $p|ab,$ $p|p(bd^{-1}y),$ значит, $p$ делит всю правую часть последнего равенства, а вместе с ней и элемент $b,$ что и требовалось доказать.
\end{proof}

\begin{thm} Область главных идеалов  является факториальным кольцом. Доказательство единственности.
\end{thm}

\begin{proof}
Требуется доказать, что если любой необратимый ненулевой элемент $a$ из области главных идеалов раскладывается сразу в два  произведения $p_1,\ldots, p_m$ и $q_1,\ldots,q_n$ одновременно, где все $p_i,q_j$ неприводимы, то это на самом деле одно и то же произведение, но с точностью до порядка сомножителей и ассоциированности. Для определенности будем считать, что $m\geqslant n.$ Докажем, стало быть, индукцией по $m.$

База индукции: $m=1.$ Но тогда $n=1$ и $q_1=p_1,$ и все доказалось автоматически.

Индукционный переход. Итак, $a=\prod\limits_{i=1}^m{p_i}=\prod\limits_{i=1}^n{q_i}.$ В силу предыдущего следствия (точнее, его аналога для любого конечного произведения, который доказывается той же индукцией, но не суть) неприводимый $p_m$ делит произведение $q_i$ от $1$ до $n$ и поэтому делит некоторый $q_i.$ Чтобы не заморачиваться, скажем, что $i=n.$ Так вот, $p_m|q_n,$ $q_n = p_me$ и вдобавок $p_m$ и $q_n$ ассоциированы.

\setcounter{equation}{0}
\begin{align}
	p_1\cdot \ldots \cdot p_m = q_1 \cdot \ldots \cdot q_n = q_1 \cdot \ldots \cdot p_m e
\end{align}
Выполним сокращение на $p_m.$
\begin{align}
		p_1\cdot \ldots \cdot p_{m-1} = q_1 \cdot \ldots \cdot p_{n-1} e = q_1 \cdot \ldots \cdot q_{n-2} (q_{n-1} e)
\end{align}
В силу леммы \ref{EquivOfPrimes} $(q_{n-1} e)$ тоже неприводим, и его можно считать за один элемент. Тогда применимо индукционное предположение. Итак, $m-1=n-1,$ первые $n-1$ $q_i$ и $p_i$ совпадают с точностью до порядка сомножителей и ассоциированности. Ну а если к этим наборам добавить "`сокращенные"' ранее $p_n$ и $q_n,$ то равенство "`с точностью до..."' никуда не пропадет. 
\end{proof}

{\bf Факт:} Если $A$ --- факториальное кольцо, то факториально также и $A[X].$

В частности, из этого факта следует, что факториальны кольца $\mathbb{Z}[X],$ $\k[X][Y] = \k[X,Y],$ где $\k$ --- произвольное поле, которые, кстати, не являются областями главных идеалов.

\subsection{Кратные корни и производная многочлена}

\begin{defn} Рассмотрим коммутативное кольцо $A$. $f\in A[X],$ $n\in \mathbb{N},$ $c\in A.$ 

Элемент $c$ называется корнем $f$ кратности $n,$ если $(x-c)^n|f,$ но $(x-c)^{n+1}\not | f.$ Простой корень --- это корень кратности $1$.
\end{defn}

Отметим, что у любого корня существует кратность, поскольку из равенства $f=(x-c)^kg,$ факта, что старший коэффициент $(x-c)^k$ не делитель нуля (и вообще равен $1$) и свойств степени вытекает, что $\deg f = \deg (x-c)^k + \deg g = k + \deg g,$ откуда видно, что число, сколько раз $x-c$ делит многочлен $f$, ограниченно и не может превышать даже степени $f$.

\begin{prop} 
Пусть $A$ --- область целостности, $f\in A[X], f\neq 0,$ $c_1,\ldots, c_k$ --- некоторые различные корни $f$ кратностей соответственно $n_1,\ldots,n_k,$ тогда $f=(x-c_1)^{n_1}\ldots (x-c_k)^{n_k}g,$ причем $c_1,\ldots, c_k$ корнями многочлена $g$ не являются.
\end{prop}
\begin{proof}
Метод математической индукции по $k$ нам в руки. 

Если $k=1,$ то из определения кратной степени $(x-c_1)^{n_1}|f,$ и $f=(x-c_1)^{n_1}g$ и, опять же по определению кратной степени, $(x-c_1)\not | g,$ а значит, $c_1$ не корень $g.$

Докажем индукционный переход. Имеется многочлен $f$ с корнями $c_1,\ldots, c_k$ заданных кратностей $n_1,\ldots,n_k.$ По базе индукции $f=(x-c_k)^{n_k}f_1,$ $f_1(c_k)\neq 0.$ Также понятно, что все остальные корни $f$ будут корнями $f_1,$ поэтому для применения индукционного перехода нужно доказать(по индукции), что кратности будут теми же, не меньше (кратность больше быть точно не может, ведь если многочлен на что-то не делится, то не делится и никакой его сомножитель). Ну куда ж этим кратностям деться. Базой индукции будет теорема Безу. Переход. Предположим, что $(x-c_i)^{m-1} | f_1$ для некоторого $1<m\leqslant n_i,$ тогда $(x-c_k)^{n_k}f_1 = (x-c_k)^{n_k}(x-c_i)^{m-1}h = f=(x-c_i)^{n_i}g,$ и, поскольку $A$ --- область целостности, $(x-c_k)^{n_k}h =(x-c_i)^{n_i-m+1} g.$ Если подставить $x=c_i,$ то при $n_i-m+1 > 0$ получится, что $(c_i-c_k)^{n_k}h(c_i)=0,$ поэтому $(x-c_i)|h$ и вместе с этим $(x-c_i)^m | f_1.$

Итак, $f_1$ имеет корни $c_1,...c_{k-1}$ тех же кратностей, что и $f.$ Применим индукционное предположение и получим, что $f_1= (x-c_1)^{n_1} \ldots (x-c_{k-1})^{n_{k-1}}t,$ где $t$ не имеет среди своих корней $c_1,...c_{k-1}$. Также полином $t$ не делится на бином $(x-c_k),$ поскольку $f_1$ на него не делится. Поэтому равенство $f = (x-c_k)^{n_k}f_1 = (x-c_1)^{n_1} \ldots (x-c_{k-1})^{n_{k-1}}(x-c_k)^{n_k} t$ с точностью до обозначений как раз то, что нам нужно.
\end{proof}

\setcounter{cor}{0}

\begin{cor} Пусть $A$ --- область целостности, $f\in A[X],$ $f\neq 0,$ $c_1,\ldots, c_k$ --- какие-то его корни. Тогда сумма их кратностей не превосходит степени $f.$ 
\end{cor}
\begin{proof} Доказывается "`пририсовыванием"' значка степени к равенству из предыдущего предложения.
\end{proof}

\begin{cor}
Число корней многочлена с коэффициентами из области целостности степени $d$ не превосходит $d$.
\end{cor}

